function cov_thxyporjj(){var path="/Users/rasikh/Desktop/Tap testing/my-fastify-app/nodb-api/functions/routes.js";var hash="d9e18f190a1d4430b95a6d9286f1827d3327baa2";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/rasikh/Desktop/Tap testing/my-fastify-app/nodb-api/functions/routes.js",statementMap:{"0":{start:{line:1,column:16},end:{line:1,column:35}},"1":{start:{line:2,column:0},end:{line:75,column:2}},"2":{start:{line:3,column:2},end:{line:11,column:4}},"3":{start:{line:13,column:2},end:{line:21,column:5}},"4":{start:{line:14,column:28},end:{line:14,column:60}},"5":{start:{line:15,column:17},end:{line:15,column:55}},"6":{start:{line:20,column:4},end:{line:20,column:16}},"7":{start:{line:23,column:2},end:{line:51,column:4}},"8":{start:{line:32,column:30},end:{line:32,column:62}},"9":{start:{line:33,column:21},end:{line:41,column:7}},"10":{start:{line:44,column:6},end:{line:48,column:7}},"11":{start:{line:45,column:22},end:{line:45,column:73}},"12":{start:{line:46,column:8},end:{line:46,column:27}},"13":{start:{line:47,column:8},end:{line:47,column:20}},"14":{start:{line:49,column:6},end:{line:49,column:39}},"15":{start:{line:53,column:2},end:{line:72,column:4}},"16":{start:{line:61,column:30},end:{line:61,column:63}},"17":{start:{line:62,column:21},end:{line:64,column:8}},"18":{start:{line:65,column:6},end:{line:69,column:7}},"19":{start:{line:66,column:22},end:{line:66,column:73}},"20":{start:{line:67,column:8},end:{line:67,column:27}},"21":{start:{line:68,column:8},end:{line:68,column:20}},"22":{start:{line:70,column:6},end:{line:70,column:39}},"23":{start:{line:74,column:2},end:{line:74,column:9}}},fnMap:{"0":{name:"todoRoutes",decl:{start:{line:2,column:26},end:{line:2,column:36}},loc:{start:{line:2,column:54},end:{line:75,column:1}},line:2},"1":{name:"readTodos",decl:{start:{line:13,column:39},end:{line:13,column:48}},loc:{start:{line:13,column:65},end:{line:21,column:3}},line:13},"2":{name:"updateTodo",decl:{start:{line:31,column:19},end:{line:31,column:29}},loc:{start:{line:31,column:46},end:{line:50,column:5}},line:31},"3":{name:"deleteTodo",decl:{start:{line:60,column:19},end:{line:60,column:29}},loc:{start:{line:60,column:46},end:{line:71,column:5}},line:60}},branchMap:{"0":{loc:{start:{line:38,column:20},end:{line:38,column:66}},type:"cond-expr",locations:[{start:{line:38,column:49},end:{line:38,column:59}},{start:{line:38,column:62},end:{line:38,column:66}}],line:38},"1":{loc:{start:{line:44,column:6},end:{line:48,column:7}},type:"if",locations:[{start:{line:44,column:6},end:{line:48,column:7}},{start:{line:44,column:6},end:{line:48,column:7}}],line:44},"2":{loc:{start:{line:65,column:6},end:{line:69,column:7}},type:"if",locations:[{start:{line:65,column:6},end:{line:69,column:7}},{start:{line:65,column:6},end:{line:69,column:7}}],line:65}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"d9e18f190a1d4430b95a6d9286f1827d3327baa2"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_thxyporjj=function(){return actualCoverage;};}return actualCoverage;}cov_thxyporjj();const schemas=(cov_thxyporjj().s[0]++,require("./schema"));cov_thxyporjj().s[1]++;module.exports=function todoRoutes(app,opts,next){cov_thxyporjj().f[0]++;cov_thxyporjj().s[2]++;app.post("/api/ghost",{schema:{body:schemas.todoInputSchema}},create);cov_thxyporjj().s[3]++;app.get("/api/ghost",async function readTodos(request,reply){cov_thxyporjj().f[1]++;const todosCollection=(cov_thxyporjj().s[4]++,app.mongo.db.collection("users"));const docs=(cov_thxyporjj().s[5]++,await todosCollection.find().toArray());// return docs.map(d =>
//   // remove the _id field and name it as id
//   d.id = d._id.toString()
//   return d
cov_thxyporjj().s[6]++;return docs;});cov_thxyporjj().s[7]++;app.put("/api/ghost/:id",{schema:{params:schemas.todoIdSchema,body:schemas.todoUpdateSchema}},async function updateTodo(request,reply){cov_thxyporjj().f[2]++;const todosCollection=(cov_thxyporjj().s[8]++,app.mongo.db.collection("users"));const result=(cov_thxyporjj().s[9]++,await todosCollection.updateOne({_id:this.mongo.ObjectId(request.params.id)},{$set:{done:request.body.done,doneAt:request.body.done===true?(cov_thxyporjj().b[0][0]++,new Date()):(cov_thxyporjj().b[0][1]++,null)}}));// returns 404 is the todo is not found
cov_thxyporjj().s[10]++;if(result.matchedCount===0){cov_thxyporjj().b[1][0]++;const error=(cov_thxyporjj().s[11]++,new Error("Object not found: "+request.params.id));cov_thxyporjj().s[12]++;error.status=404;cov_thxyporjj().s[13]++;throw error;}else{cov_thxyporjj().b[1][1]++;}cov_thxyporjj().s[14]++;return{id:request.params.id};});cov_thxyporjj().s[15]++;app.delete("/api/ghost/:id",{schema:{params:schemas.todoIdSchema}},async function deleteTodo(request,reply){cov_thxyporjj().f[3]++;const todosCollection=(cov_thxyporjj().s[16]++,this.mongo.db.collection("users"));const result=(cov_thxyporjj().s[17]++,await todosCollection.deleteOne({_id:this.mongo.ObjectId(request.params.id)}));cov_thxyporjj().s[18]++;if(result.deletedCount===0){cov_thxyporjj().b[2][0]++;const error=(cov_thxyporjj().s[19]++,new Error("Object not found: "+request.params.id));cov_thxyporjj().s[20]++;error.status=404;cov_thxyporjj().s[21]++;throw error;}else{cov_thxyporjj().b[2][1]++;}cov_thxyporjj().s[22]++;return{id:request.params.id};});cov_thxyporjj().s[23]++;next();};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzY2hlbWFzIiwicmVxdWlyZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJ0b2RvUm91dGVzIiwiYXBwIiwib3B0cyIsIm5leHQiLCJwb3N0Iiwic2NoZW1hIiwiYm9keSIsInRvZG9JbnB1dFNjaGVtYSIsImNyZWF0ZSIsImdldCIsInJlYWRUb2RvcyIsInJlcXVlc3QiLCJyZXBseSIsInRvZG9zQ29sbGVjdGlvbiIsIm1vbmdvIiwiZGIiLCJjb2xsZWN0aW9uIiwiZG9jcyIsImZpbmQiLCJ0b0FycmF5IiwicHV0IiwicGFyYW1zIiwidG9kb0lkU2NoZW1hIiwidG9kb1VwZGF0ZVNjaGVtYSIsInVwZGF0ZVRvZG8iLCJyZXN1bHQiLCJ1cGRhdGVPbmUiLCJfaWQiLCJPYmplY3RJZCIsImlkIiwiJHNldCIsImRvbmUiLCJkb25lQXQiLCJEYXRlIiwibWF0Y2hlZENvdW50IiwiZXJyb3IiLCJFcnJvciIsInN0YXR1cyIsImRlbGV0ZSIsImRlbGV0ZVRvZG8iLCJkZWxldGVPbmUiLCJkZWxldGVkQ291bnQiXSwic291cmNlcyI6WyJyb3V0ZXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2NoZW1hcyA9IHJlcXVpcmUoXCIuL3NjaGVtYVwiKTtcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gdG9kb1JvdXRlcyhhcHAsIG9wdHMsIG5leHQpIHtcbiAgYXBwLnBvc3QoXG4gICAgXCIvYXBpL2dob3N0XCIsXG4gICAge1xuICAgICAgc2NoZW1hOiB7XG4gICAgICAgIGJvZHk6IHNjaGVtYXMudG9kb0lucHV0U2NoZW1hLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGNyZWF0ZVxuICApO1xuXG4gIGFwcC5nZXQoXCIvYXBpL2dob3N0XCIsIGFzeW5jIGZ1bmN0aW9uIHJlYWRUb2RvcyhyZXF1ZXN0LCByZXBseSkge1xuICAgIGNvbnN0IHRvZG9zQ29sbGVjdGlvbiA9IGFwcC5tb25nby5kYi5jb2xsZWN0aW9uKFwidXNlcnNcIik7XG4gICAgY29uc3QgZG9jcyA9IGF3YWl0IHRvZG9zQ29sbGVjdGlvbi5maW5kKCkudG9BcnJheSgpO1xuICAgIC8vIHJldHVybiBkb2NzLm1hcChkID0+XG4gICAgLy8gICAvLyByZW1vdmUgdGhlIF9pZCBmaWVsZCBhbmQgbmFtZSBpdCBhcyBpZFxuICAgIC8vICAgZC5pZCA9IGQuX2lkLnRvU3RyaW5nKClcbiAgICAvLyAgIHJldHVybiBkXG4gICAgcmV0dXJuIGRvY3M7XG4gIH0pO1xuXG4gIGFwcC5wdXQoXG4gICAgXCIvYXBpL2dob3N0LzppZFwiLFxuICAgIHtcbiAgICAgIHNjaGVtYToge1xuICAgICAgICBwYXJhbXM6IHNjaGVtYXMudG9kb0lkU2NoZW1hLFxuICAgICAgICBib2R5OiBzY2hlbWFzLnRvZG9VcGRhdGVTY2hlbWEsXG4gICAgICB9LFxuICAgIH0sXG4gICAgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVG9kbyhyZXF1ZXN0LCByZXBseSkge1xuICAgICAgY29uc3QgdG9kb3NDb2xsZWN0aW9uID0gYXBwLm1vbmdvLmRiLmNvbGxlY3Rpb24oXCJ1c2Vyc1wiKTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRvZG9zQ29sbGVjdGlvbi51cGRhdGVPbmUoXG4gICAgICAgIHsgX2lkOiB0aGlzLm1vbmdvLk9iamVjdElkKHJlcXVlc3QucGFyYW1zLmlkKSB9LFxuICAgICAgICB7XG4gICAgICAgICAgJHNldDoge1xuICAgICAgICAgICAgZG9uZTogcmVxdWVzdC5ib2R5LmRvbmUsXG4gICAgICAgICAgICBkb25lQXQ6IHJlcXVlc3QuYm9keS5kb25lID09PSB0cnVlID8gbmV3IERhdGUoKSA6IG51bGwsXG4gICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgICAgKTtcblxuICAgICAgLy8gcmV0dXJucyA0MDQgaXMgdGhlIHRvZG8gaXMgbm90IGZvdW5kXG4gICAgICBpZiAocmVzdWx0Lm1hdGNoZWRDb3VudCA9PT0gMCkge1xuICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk9iamVjdCBub3QgZm91bmQ6IFwiICsgcmVxdWVzdC5wYXJhbXMuaWQpO1xuICAgICAgICBlcnJvci5zdGF0dXMgPSA0MDQ7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHsgaWQ6IHJlcXVlc3QucGFyYW1zLmlkIH07XG4gICAgfVxuICApO1xuXG4gIGFwcC5kZWxldGUoXG4gICAgXCIvYXBpL2dob3N0LzppZFwiLFxuICAgIHtcbiAgICAgIHNjaGVtYToge1xuICAgICAgICBwYXJhbXM6IHNjaGVtYXMudG9kb0lkU2NoZW1hLFxuICAgICAgfSxcbiAgICB9LFxuICAgIGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVRvZG8ocmVxdWVzdCwgcmVwbHkpIHtcbiAgICAgIGNvbnN0IHRvZG9zQ29sbGVjdGlvbiA9IHRoaXMubW9uZ28uZGIuY29sbGVjdGlvbihcInVzZXJzXCIpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdG9kb3NDb2xsZWN0aW9uLmRlbGV0ZU9uZSh7XG4gICAgICAgIF9pZDogdGhpcy5tb25nby5PYmplY3RJZChyZXF1ZXN0LnBhcmFtcy5pZCksXG4gICAgICB9KTtcbiAgICAgIGlmIChyZXN1bHQuZGVsZXRlZENvdW50ID09PSAwKSB7XG4gICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiT2JqZWN0IG5vdCBmb3VuZDogXCIgKyByZXF1ZXN0LnBhcmFtcy5pZCk7XG4gICAgICAgIGVycm9yLnN0YXR1cyA9IDQwNDtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgICByZXR1cm4geyBpZDogcmVxdWVzdC5wYXJhbXMuaWQgfTtcbiAgICB9XG4gICk7XG5cbiAgbmV4dCgpO1xufTtcbiJdLCJtYXBwaW5ncyI6IjB3R0FlWTt5RkFmWixLQUFNQSxRQUFPLHlCQUFHQyxPQUFPLENBQUMsVUFBRCxDQUFWLENBQWIsQyx1QkFDQUMsTUFBTSxDQUFDQyxPQUFQLENBQWlCLFFBQVNDLFdBQVQsQ0FBb0JDLEdBQXBCLENBQXlCQyxJQUF6QixDQUErQkMs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